<html><head>
  <meta content="text/html; charset=UTF-8" http-equiv="content-type">
  <title>htmlwrap - jsFiddle demo by kzvikzvi1</title>
  <link rel="stylesheet" href="http://code.jquery.com/ui/1.10.3/themes/smoothness/jquery-ui.css" />
  <script src="http://code.jquery.com/jquery-1.9.1.js" type="text/javascript"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js"></script>
  <script src="http://bitwiseshiftleft.github.io/sjcl/sjcl.js" type="text/javascript"></script>
  
  
  <link href="/css/result-light.css" type="text/css" rel="stylesheet">
  
  <style type="text/css">
    textarea {
    width: 100%; 
    height: 635px;
    }
    
div.container {
    margin: auto;   
    width: 100%;
}

div.left {
    float: left;
    width: 40%;
}

div.center {
    float: left;
    width: 12%;
    border: 2px solid #dddddd;
    margin: 10px;

}
div.right {
    float: left;
    width: 40%;
}
  </style>
  


<script type="text/javascript">//&lt;![CDATA[ 
$(window).load(function(){

if (jQuery.ui) {
	$('#dialog').dialog({
		autoOpen : false,
		width : 'auto',
		title : 'Enter Password'
	});
} else {
	log('jQuery UI not loaded yet');
}
  
      var selectors = { encryptedText: '#encryptedText', 
  			target: '#encryptedText',
  			password:'#password',
  			dialog:'#dialog',
  			message:'#message'
  		};
 

    $("#showtext").focus(function () {
        var $this = $(this);
        $this.select();

        // Work around Chrome's little problem
        $this.mouseup(function () {
            // Prevent further mouseup intervention
            $this.unbind("mouseup");
            return false;
        });
    });
    $("#fulltext").focus(function () {
        var $this = $(this);
        $this.select();

        // Work around Chrome's little problem
        $this.mouseup(function () {
            // Prevent further mouseup intervention
            $this.unbind("mouseup");
            return false;
        });
    });

   
    var originalText = $('#fulltext').val();
    $('#reset').click(function () {
        $('#fulltext').val(originalText);
        $('#showtext').val('');
    });
    
	$('#encrypt').click(function(){
		if(sjcl) {
		var value = $('#fulltext').val();
		var pass = $('#text-password').val();
		 $('#showtext').val(sjcl.encrypt(pass, value));
		 $('#fulltext').val('');	
		 } else {
		 	log('cant find encryption lib');
		 }
	});

	$('#decrypt').click(function(){
		 $('#dialog').dialog('open');
	});

	$('#submit').click(function(){
		$('#message').text('');
		 if(validatePassword()) {
		 	var value = $('#showtext').val();
		 	log('Trying decrypt'); 
		 	var plaintext = sjcl.decrypt($('#password').val() ,value,{},{});
		 	$('#fulltext').val(plaintext);
		 	$('#showtext').val('');				
		 	$('#dialog').dialog('close');			
	    	log('Decrypted');
		 } else {
		 	$('#message').text('Please provide a valid password').css('color', 'red');
		 }
	});
	
	
    var error = function (msg) {
        $('#log').text(msg).css('color', 'red');
    };
    var log = function (msg) {
        if (console.log) {
            console.log(msg);
        }
        $('#log').text(msg).css('color', 'black');
    };
	var validatePassword = function() {
		var value = '{"iv":"fAtPITLOyR5xiy7KmTA1TA==","v":1,"iter":1000,"ks":128,"ts":64,"mode":"ccm","adata":"","cipher":"aes","salt":"OiwC5/fIlpA=","ct":"1nYEWPJf4QBFA+cvNDV50aT2kUw="}';
		try {
			return sjcl.decrypt($(selectors.password).val(), value, {}, {}) === $(selectors.password).val();
		} catch(e) {
			log('Invalid Password');
		} 
		return false;
	};

});//]]&gt;  

</script>


</head>
<body>
<div class="container">
<div class="left">
<textarea id="fulltext"></textarea>
</div>
<div class="center">
<div id="log"></div>
<input type="text" id="text-password"/>
<button id="encrypt">Encrypt >>></button><br />
<button id="decrypt"><<<< Decrypt</button><br />
<button id="reset">Reset</button>
</div>
<div class="right">
<textarea id="showtext"></textarea>
</div >
</div>

<div id="dialog">
<span id="message"></span><br/>
<label for="password">Enter Password</label>
<input type="password" id="password"/>
<button id="submit">Submit</button>
</div>

  





</body></html>